--- #!possible_aws_key
diff: add
line:
    - match: AKIA.*
description: "AWS user keys should come from chef and not being hardcoded in the source."

--- #!password_in_source
diff: add
line:
    - match: '(secret|password|S3Connection)+[\w_]*[\s]*=.+'
    - except: 'aws_secret\s*=>\s*(aws_secret|<%=)'
    - except: '.+=\s*(get_encrypted_data|{{ S3_SECRET_KEY }}|prezi_app_secrets|chef_secrets|settings\.|StringOption\(\)|<%=.*?(password|secret))'
    - except: UITextField|UIButton|PZObjectLogField
file:
    - except: .*(/scripts/build|/scripts/common|/scripts/release|/scripts/bootstrap)

--- #!chef_node_secret
diff: all
line:
    - match: 'node\..*?\s*=.*?(secret|password|cred)'
description: "Node properties are uploaded to Chef server in plaintext, so please don't use it for secrets."
file:
    - match: \.rb$
